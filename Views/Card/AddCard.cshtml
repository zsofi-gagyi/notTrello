@using TodoWithDatabase.Models.DAOs;
@using TodoWithDatabase.Models.DAOs.JoinTables;

@{
    Layout = "_userLayout";
}

@{var project = (Project)ViewData["project"];
    <div class="displayCardsContainer mainPageContainer firstContainer">
        <div class="displayCard">
            <div class="title">Add new card to the project "@project.Title"</div>
            <form action="/users/projects/@project.Id/cards/addCard" method="POST">
                <div id="inputContainer">
                    <input type="text" name="Title" placeholder="Title" required />
                    <textarea class="description" name="Description" placeholder="Description" required></textarea>
                    <input id="dateTimePicker" type="datetime-local" name="Deadline" placeholder="Deadline" required />
                    @await Html.PartialAsync("_ScriptForDatePickingPartial.cshtml")
                    <div class="responsibles">
                        <label for="multipleSelector">Collaborating with:</label>
                        <select id="multipleSelector" multiple name="collaboratorIds">
                            <option value="" disabled hidden>Select collaborator(s)</option>
                            @{ var otherResponsibles = project.AssigneeProjects.Where(ap => !ap.Assignee.UserName.Equals(User.Identity.Name));
                                foreach (AssigneeProject assigneeProject in otherResponsibles)
                                {
                                    <option value="@assigneeProject.Assignee.Id">@assigneeProject.Assignee.UserName</option>
                                }
                            }
                       </select>
                        @await Html.PartialAsync("~/Views/Shared/_ScriptForMultipleSelectPartial.cshtml")
                    </div>
                    <button class="largeButton" type="submit">Submit</button>
                </div>
            </form>
        </div>
    </div>
 }
       
